# -*- coding: utf-8 -*-
"""01. 통계데이터분석 - 선형회귀vsKNN회귀.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1h-AkYuMJMxIkqpSdOPDXnJ7KLpk1pdtN

선형 회귀 vs KNN 회귀


선형 회귀 : 종속 변수 y와 한 개 이상의 독립 변수 x와의 선형 상관관계를 모델링하는 회귀분석 기법

    y = wx + b
    y : 종속 변수
    x : 독립 변수
    w : 가중치
    b : qusgid

KNN 회귀 : 특징 공간 내 k개의 가장 가까운 훈련 데이터의 평균을 통해 예측
"""

import numpy as np
n = 1000
heights = np.random.normal(174, 8, n)  # 정규분포 따르는 1000개의 데이터 생성, 평균 178, 표준편차 8인 데이터

heights2 = [height//5 for height in heights]
import pandas as pd
se = pd.Series(heights2)
svc = se.value_counts()

import matplotlib.pyplot as plt

plt.bar(svc.index, svc.values)
plt.show()

bmi = np.random.normal(21, 1, n)
weights = bmi * (heights**2)/10000  # bmi = w / (txt), t의 단위는 m

plt.figure(figsize=(10, 5))
plt.plot(heights, weights, '.')
plt.xlabel('height')
plt.ylabel('weight')
plt.xlim(0, 220)
plt.ylim(0, 110)
plt.grid(True)
plt.show()

# xs = [ [weight] for weight in weights ]
# 독립변수는 여러 개의 특성으로 구성할 수 있어서 ML 모델에서는 2차원 배열 형태로 학습 데이터를 입력받음
xs = weights.reshape(-1, 1)
xs.shape

xs2 = xs.reshape(5, 20, -1)
xs2.shape

xs3 = xs.reshape(3, 20, -1)  # 3x20 (60) 1000이 나누어 떨어지지 않아서 오류 발생 (Tensor 데이터가 아님)
xs3.shape

# 종속 변수는 하나의 값이며 ML 모델에서 1차원 배열 형태로 학습 데이터를 입력받음
ys = heights
ys.shape

from sklearn.linear_model import LinearRegression
lr_model = LinearRegression()  # 모델 객체 생성
lr_model.fit(xs, ys)  # 학습
lr_model.coef_, lr_model.intercept_  # 가중치, 편향

txs = np.array([ [50], [60], [67], [70], [94] ])

pred_val1 = lr_model.predict(txs)
pred_val1

from sklearn.model_selection import train_test_split

# train_test_split() : 주어진 값을 섞어서 일부 데이터는 학습으로, 일부 데이터는 테스트용으로 사용
train_xs, test_xs, train_ys, test_ys = train_test_split(xs, ys, train_size = 0.8)
train_xs.shape, test_xs.shape, train_ys.shape, test_ys.shape

lr_model = LinearRegression()  # 모델 객체 생성
lr_model.fit(xs, ys)  # 학습
train_score = lr_model.score(train_xs, train_ys)  # 평가하시오
test_score = lr_model.score(test_xs, test_ys)  # 평가하시오
train_score, test_score  # 편차가 적은 데이터일 경우 숫자 크게 나옴, 숫자 클수록 점수 높음

"""![image.png](data:image/png;base64,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)
![image.png](data:image/png;base64,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) ![image.png](data:image/png;base64,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)

SST에 사용한 값은 평균과 실제 값

SSR에 사용한 값은 평균과 예측 값
"""

from sklearn.neighbors import KNeighborsRegressor

knr_model = KNeighborsRegressor()  # 모델 객체 생성
knr_model.fit(xs, ys)
pred_val2 = knr_model.predict(txs)
pred_val2

train_score = knr_model.score(train_xs, train_ys)  # 평가하시오
test_score = knr_model.score(test_xs, test_ys)  # 평가하시오
train_score, test_score  # 편차가 적은 데이터일 경우 숫자 크게 나옴, 숫자 클수록 점수 높음

"""## KNN에서 주의할 점

인접한 이웃을 찾아 이웃의 평균값으로 회귀함

max, min값과 차이가 큰 데이터가 들어오면 정확도가 떨어진다
"""

pv1 = lr_model.predict([ [35], [108], [120], [130] ])
pv2 = knr_model.predict([ [35], [108], [120], [130] ])
pv1, pv2

pv1 = lr_model.predict([ [35], [82], [85], [90], [100], [108], [120], [130] ])
pv2 = knr_model.predict([ [35], [82], [85], [90], [100], [108], [120], [130] ])
pv1, pv2

plt.figure(figsize=(10, 5))
plt.plot(heights, weights, '.')
plt.plot([143.68, 193.34, 196.51, 201.79, 212.35, 220.80, 233.48, 244.04], [35, 82, 85, 90, 100, 108, 120, 130], 'bo', label='lr')
plt.plot([156.84 , 192.05, 194.26, 194.26, 194.26, 194.26, 194.26, 194.26], [35, 82, 85, 90, 100, 108, 120, 130], 'r^', label='knr')
plt.xlabel('height')
plt.ylabel('weight')
plt.xlim(0, 270)
plt.ylim(0, 135)
plt.grid(True)
plt.show()

"""np.random.normal() - 정규분포에 해당되는 랜덤 값 생성

지도 학습 vs 비지도 학습
"""